@using SO.Application.DTOs.ProposalModule.Proposal
@model SO.Application.Features.Queries.ProposalModule.Proposal.GetByIdProposal.GetByIdProposalQueryResponse

@{
    var proposal = Model.Result as SingleProposal;
    var initiator = proposal.ProjectStakeholders?.FirstOrDefault(p => p.Role == "Project Initiator") ?? new SO.Application.DTOs.ProposalModule.ProjectStakeholder.ListProjectStakeholder { Role = "Project Initiator" };
    var sponsor = proposal.ProjectStakeholders?.FirstOrDefault(p => p.Role == "Project Sponsor") ?? new SO.Application.DTOs.ProposalModule.ProjectStakeholder.ListProjectStakeholder { Role = "Project Sponsor" };
}

<div class="card">
    <div class="card-header"><h5 class="card-title mb-0">Identify Project Initiator and/or Sponsor</h5></div>
    <div class="card-body">
        <form asp-action="UpdateInitiatorSponsor" asp-route-id="@proposal.Id" method="post">
            @Html.AntiForgeryToken()
            <input type="hidden" name="Id" value="@proposal.Id" />
            <table class="table table-bordered">
                <thead class="table-light">
                    <tr>
                        <th style="width: 20%;">Role</th>
                        <th style="width: 30%;">Names</th>
                        <th style="width: 50%;">Responsibilities</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            Project Initiator
                            <input type="hidden" name="Stakeholders[0].Role" value="Project Initiator" />
                        </td>
                        <td><input name="Stakeholders[0].Name" class="form-control" value="@initiator.Name" /></td>
                        <td><textarea name="Stakeholders[0].Responsibilities" class="form-control" rows="2">@initiator.Responsibilities</textarea></td>
                    </tr>
                    <tr>
                        <td>
                            Project Sponsor
                            <input type="hidden" name="Stakeholders[1].Role" value="Project Sponsor" />
                        </td>
                        <td><input name="Stakeholders[1].Name" class="form-control" value="@sponsor.Name" /></td>
                        <td><textarea name="Stakeholders[1].Responsibilities" class="form-control" rows="2">@sponsor.Responsibilities</textarea></td>
                    </tr>
                </tbody>
            </table>
            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary">Kaydet ve Devam Et</button>
            </div>
        </form>
    </div>
</div>
